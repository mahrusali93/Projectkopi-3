<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kasir Kopi</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 font-sans">
  <div class="max-w-5xl mx-auto py-8">
    <h1 class="text-3xl font-bold mb-6 text-center">Kasir Kopi Shop</h1>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8" id="menu-list"></div>

    <h2 class="text-2xl font-semibold mb-4">Pesanan</h2>
    <div class="bg-white rounded shadow p-4">
      <table class="w-full text-left mb-4">
        <thead>
          <tr>
            <th>Item</th>
            <th>Jumlah</th>
            <th>Harga</th>
            <th>Total</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="order-table"></tbody>
      </table>
      <div class="text-right font-bold text-xl mb-4">Total: Rp <span id="grand-total">0</span></div>
      <button onclick="cetakStruk()" class="bg-green-600 text-white px-4 py-2 rounded">Cetak Struk</button>
    </div>
  </div>

  <script>
    const menu = [{"nama": "Espresso", "harga": 15000}, {"nama": "Cappuccino", "harga": 25000}, {"nama": "Latte", "harga": 23000}, {"nama": "Americano", "harga": 20000}, {"nama": "Flat White", "harga": 24000}, {"nama": "Mochaccino", "harga": 27000}];
    const order = [];

    function renderMenu() {
      const list = document.getElementById("menu-list");
      menu.forEach((item, idx) => {
        const div = document.createElement("div");
        div.className = "bg-white p-4 rounded shadow text-center";
        div.innerHTML = `
          <h3 class='font-semibold text-lg mb-2'>${item.nama}</h3>
          <p class='mb-2'>Rp ${item.harga}</p>
          <button onclick="addToOrder(${idx})" class='bg-blue-600 text-white px-3 py-1 rounded'>Tambah</button>
        `;
        list.appendChild(div);
      });
    }

    function addToOrder(idx) {
      const existing = order.find(o => o.nama === menu[idx].nama);
      if (existing) {
        existing.jumlah += 1;
      } else {
        order.push({ ...menu[idx], jumlah: 1 });
      }
      renderOrder();
    }

    function removeItem(idx) {
      order.splice(idx, 1);
      renderOrder();
    }

    
function renderOrder() {
  const table = document.getElementById("order-table");
  table.innerHTML = "";
  let totalJumlah = order.reduce((sum, item) => sum + item.jumlah, 0);
  let multiplier = 1;
  if (totalJumlah > 5) {
    multiplier = 1.1; // naik 10%
  } else if (totalJumlah < 3) {
    multiplier = 0.9; // turun 10%
  }
  let total = 0;
  order.forEach((item, idx) => {
    const hargaDinamis = Math.round(item.harga * multiplier);
    const itemTotal = hargaDinamis * item.jumlah;
    total += itemTotal;
    const row = `
      <tr>
        <td>${item.nama}</td>
        <td>${item.jumlah}</td>
        <td>Rp ${hargaDinamis}</td>
        <td>Rp ${itemTotal}</td>
        <td><button onclick="removeItem(${idx})" class="text-red-500">Hapus</button></td>
      </tr>
    `;
    table.innerHTML += row;
  });
  document.getElementById("grand-total").textContent = total;
}

      const table = document.getElementById("order-table");
      table.innerHTML = "";
      let total = 0;
      order.forEach((item, idx) => {
        const itemTotal = item.harga * item.jumlah;
        total += itemTotal;
        const row = `
          <tr>
            <td>${item.nama}</td>
            <td>${item.jumlah}</td>
            <td>Rp ${item.harga}</td>
            <td>Rp ${itemTotal}</td>
            <td><button onclick="removeItem(${idx})" class="text-red-500">Hapus</button></td>
          </tr>
        `;
        table.innerHTML += row;
      });
      document.getElementById("grand-total").textContent = total;
    }

    function cetakStruk() {
      let struk = "=== Struk Pembelian ===\n";
      order.forEach(item => {
        struk += `${item.nama} x${item.jumlah} - Rp ${item.harga * item.jumlah}\n`;
      });
      struk += "------------------------\n";
      struk += "Total: Rp " + document.getElementById("grand-total").textContent + "\n";
      const newWin = window.open("", "", "width=400,height=600");
      newWin.document.write(`<pre>${struk}</pre>`);
      newWin.print();
    }

    renderMenu();
  </script>
</body>
</html>
